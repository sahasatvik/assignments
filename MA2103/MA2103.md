# Mathematical Methods II

$
\newcommand\C{\mathbb{C}}
\newcommand\R{\mathbb{R}}
\newcommand\Q{\mathbb{Q}}
\newcommand\Z{\mathbb{Z}}
\newcommand\N{\mathbb{N}}
\newcommand\ve[1]{\boldsymbol{#1}}
\newcommand\ppx[1]{\frac{\partial #1}{\partial x}}
\newcommand\ppt[1]{\frac{\partial #1}{\partial t}}
\newcommand\pp[3][]{\frac{\partial^{#1}{#2}}{\partial {#3}^{#1}}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}
\newcommand\grad[1]{\ve{\nabla}#1}
\newcommand\divg[1]{\ve{\nabla}\cdot#1}
\newcommand\curl[1]{\ve{\nabla}\times#1}
\newcommand\lapl[1]{\nabla^2 #1}
$


## Partial Differential Equations

A partial differential equation typically involves a number of variables $x_1, \dots, x_n$, an unknown multivariable function $u(x_1, \dots, x_n)$ as well as its partial derivatives with respect to these variables.

$$ f\left(x_1, \dots, x_n; u_{x_1}, \dots, u_{x_n}; u_{x_1x_1} \dots, u_{x_1x_n}; \dots\right) = 0. $$

Here, we use the notation
$$ u_{x_i} = \pp{u}{x_i}, \quad u_{x_ix_j} = \pp{}{x_j}\left(\pp{u}{x_i}\right), \quad\dots.$$
We may also use Newton's notation specifically to denote derivatives with respect to time.
$$ \dot{u} = \ppt{u}, \quad \ddot{u} = \pp[2]{u}{t}, \quad\dots. $$
The special operator $\grad{} = \sum \partial/\partial{x_i}\ve{e^i}$ is often used to define the *gradient*, *divergence*, and *Laplacian*  of scalar and vector fields. Let $u(\ve{x})$ be a scalar field and $\ve{q}(\ve{x})$ be a vector field, and let $\{\ve{e^i}\}$ be our standard basis.
$$ \begin{align}
\grad{u} &= \sum_i \pp{u}{x_i} \ve{e^i}. \tag{Gradient} \\
\divg{\ve{q}} &= \sum_i \pp{q_i}{x_i}. \tag{Divergence} \\
\lapl{u} &= \sum_i \pp[2]{u}{x_i}. \tag{Laplacian}
\end{align} $$
Another quantity called the *curl* is only defined in $\R^3$ as follows.
$$ \curl{\ve{q}} = \sum_i \epsilon_{ijk}\pp{q_i}{x_j}\ve{e^k}. 
\tag{Curl} $$

### Wave Equation

$$ \ddot{u} = c^2 \nabla^2{u}. $$
In one dimension, this reduces to
$$ \pp[2]{u}{t} = c^2 \pp[2]{u}{x}. $$

A class of solutions is given by $u(x, t) = A\cos(\omega (t - x/c) + \phi)$.

### Heat Equation

$$ \ppt{T} = \alpha \lapl{T}. $$

We start with Fourier's Law, which states that the local heat flux density $\ve{q}$ is related to the gradient of the temperature as $\ve{q} = -\kappa \nabla T$. 
This means that the rate of flow of heat energy per unit area is proportional to the negative gradient of temperature locally, *i.e.* heat flows in the direction of *decreasing* temperature, proportional to the thermal conductivity $\kappa$ of the material, which is a simple scalar for isotrpic materials.

The law of conservation of heat tells us that rate of change of internal heat per volume is given by $\nabla\cdot \ve{q} = -\rho\sigma\,(\partial{T}/\partial{t}) = 0$. This means that the rate of flow of heat away from a region is proportional to the rate of *decrease* in temperature of that region with time, *i.e.* loss of heat energy in a volume is directly proportional to the decrease in temperature via $Q = \rho\sigma V\Delta{T}$. Note that $\rho$ is the density of the material and $\sigma$ is its specific heat capacity.
Putting these together and using $\lapl{T} = \divg{\grad{T}}$ yields the result, with $\alpha = \kappa/\rho\sigma$.

In one dimension, this reduces to
$$ \ppt{T} = \alpha \pp[2]{T}{x}. $$

Note that for anisotropic materials, $\kappa$ is a second order tensor and hence doesn't commute with the divergence.
$$ \rho\sigma\ppt{T} = \divg{(\kappa\grad{T})}. $$


#### Diffusion Equation
The heat equation more generally describes the phenomenon of *diffusion*, when $\alpha$ is replaced by a scalar constant $D$ and $T$ is replaced by the density of the diffusing material $\phi$.

$$ \ppt{\phi} = D\lapl{\phi}. $$

#### Random walks
The diffusion equation can also be used to describe the phenomenon of random walks, such as Brownian motion, by setting $\phi = P(\ve{x}, t)$ to the probability of finding the walker at position $\ve{x}$ at time $t$.

Consider a random walk in one dimension, where the walker takes time $\tau$ per step of length $\ell$. The probability $p$ that the walker steps to the right is constant, so the probability $q$ that the walker steps left is simply $1 - p$. In this discrete case, we set $P_n(m)$ to be the probability of finding the walker at position $x = m\ell$ at time $t = n\tau$. Clearly, the walker can arrive at step $m$ only if it stepped rightwards from $m-1$ or leftwards from $m+1$, so
$$ P_{n + 1}(m) = pP_n(m-1) + qP_n(m+1). $$

In the special case that a leftward and rightward step are equally likely, *i.e.* $p = q = 1/2$, 
$$ P_{n+1}(m) - P_n(m) = \frac12(P_n(m+1) - P_n(m)) - \frac12 (P_n(m) - P_n(m - 1)). $$
In the limit of large $n$, we can approximate these quantities as differentials. Thus, using $\delta n = \delta t /\tau$ and $\delta m = \delta x /\ell$, we obtain
$$ \tau\ppt{P} = \frac{\ell^2}{2}\pp[2]{P}{x}. $$

With some rearrangement and setting $\ell^2/2\tau = D$, we identify this as the diffusion equation.

> **Question**: In the limiting process, the ratio $\ell^2/\tau$ is held constant. This seems to imply that the speed of the particle $\ell/\tau$ blows up. How do we reconcile this?

### Laplace's Equation
$$ \lapl{\phi}(\ve{x}) = 0. $$
This equation is often used to describe various physical potentials $\phi(\ve{x})$, such as gravitational or electrostatic potential in regions without matter or charge respectively.

### Poisson's Equation
$$ \lapl{\phi(\ve{x})} = f(\ve{x}). $$
This equation is often used to describe potentials in the presence of some 'source', such as gravitational or electrostatic potentials in the presence of matter or charge. Here, $f(\ve{x})$ is often called the *source density*. Note that this is a special case of the heat equation where the function $T(\ve{x})$ is independent of time.