<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>MA2103</title>


<style type="text/css">
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>


</head>

<body>

<h1 id="toc_0">Mathematical Methods II</h1>

<p>\(
\newcommand\C{\mathbb{C}}
\newcommand\R{\mathbb{R}}
\newcommand\Q{\mathbb{Q}}
\newcommand\Z{\mathbb{Z}}
\newcommand\N{\mathbb{N}}
\newcommand\ve[1]{\boldsymbol{#1}}
\newcommand\ppx[1]{\frac{\partial #1}{\partial x}}
\newcommand\ppt[1]{\frac{\partial #1}{\partial t}}
\newcommand\pp[3][]{\frac{\partial^{#1}{#2}}{\partial {#3}^{#1}}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}
\newcommand\grad[1]{\ve{\nabla}#1}
\newcommand\divg[1]{\ve{\nabla}\cdot#1}
\newcommand\curl[1]{\ve{\nabla}\times#1}
\newcommand\lapl[1]{\nabla^2 #1}
\newcommand\E[1]{\langle #1\rangle}
\)</p>

<h2 id="toc_1">Partial Differential Equations</h2>

<p>A partial differential equation typically involves a number of variables \(x_1, \dots, x_n\), an unknown multivariable function \(u(x_1, \dots, x_n)\) as well as its partial derivatives with respect to these variables.</p>

<p>\[ f\left(x_1, \dots, x_n; u_{x_1}, \dots, u_{x_n}; u_{x_1x_1} \dots, u_{x_1x_n}; \dots\right) = 0. \]</p>

<p>Here, we use the notation
\[ u_{x_i} = \pp{u}{x_i}, \quad u_{x_ix_j} = \pp{}{x_j}\left(\pp{u}{x_i}\right), \quad\dots.\]
We may also use Newton&#39;s notation specifically to denote derivatives with respect to time.
\[ \dot{u} = \ppt{u}, \quad \ddot{u} = \pp[2]{u}{t}, \quad\dots. \]</p>

<p>The special operator \(\grad{} = \sum \partial/\partial{x_i}\ve{e^i}\) is often used to define the <em>gradient</em>, <em>divergence</em>, and <em>Laplacian</em>  of scalar and vector fields. Let \(u(\ve{x})\) be a scalar field and \(\ve{q}(\ve{x})\) be a vector field, and let \(\{\ve{e^i}\}\) be our standard basis.
\[ \begin{align}
\grad{u} &amp;= \sum_i \pp{u}{x_i} \ve{e^i}. \tag{Gradient} \\
\divg{\ve{q}} &amp;= \sum_i \pp{q_i}{x_i}. \tag{Divergence} \\
\lapl{u} &amp;= \sum_i \pp[2]{u}{x_i}. \tag{Laplacian}
\end{align} \]
Another quantity called the <em>curl</em> is only defined in \(\R^3\) as follows.
\[ \curl{\ve{q}} = \sum_i \epsilon_{ijk}\pp{q_i}{x_j}\ve{e^k}. 
\tag{Curl} \]</p>

<h3 id="toc_2">Wave Equation</h3>

<p>\[ \ddot{u} = c^2 \nabla^2{u}. \]
In one dimension, this reduces to
\[ \pp[2]{u}{t} = c^2 \pp[2]{u}{x}. \]</p>

<p>A class of solutions is given by \(u(x, t) = A\cos(\omega (t - x/c) + \phi)\).</p>

<h3 id="toc_3">Heat Equation</h3>

<p>\[ \ppt{T} = \alpha \lapl{T}. \]</p>

<p>We start with Fourier&#39;s Law, which states that the local heat flux density \(\ve{q}\) is related to the gradient of the temperature as \(\ve{q} = -\kappa \nabla T\). 
This means that the rate of flow of heat energy per unit area is proportional to the negative gradient of temperature locally, <em>i.e.</em> heat flows in the direction of <em>decreasing</em> temperature, proportional to the thermal conductivity \(\kappa\) of the material, which is a simple scalar for isotropic materials.</p>

<p>The law of conservation of heat tells us that rate of change of internal heat per volume is given by \(\nabla\cdot \ve{q} = -\rho\sigma\,(\partial{T}/\partial{t}) = 0\). This means that the rate of flow of heat away from a region is proportional to the rate of <em>decrease</em> in temperature of that region with time, <em>i.e.</em> loss of heat energy in a volume is directly proportional to the decrease in temperature via \(Q = \rho\sigma V\Delta{T}\). Note that \(\rho\) is the density of the material and \(\sigma\) is its specific heat capacity.
Putting these together and using \(\lapl{T} = \divg{\grad{T}}\) yields the result, with \(\alpha = \kappa/\rho\sigma\).</p>

<p>In one dimension, this reduces to
\[ \ppt{T} = \alpha \pp[2]{T}{x}. \]</p>

<p>Note that for anisotropic materials, \(\kappa\) is a second order tensor and hence doesn&#39;t commute with the divergence.
\[ \rho\sigma\ppt{T} = \divg{(\kappa\grad{T})}. \]</p>

<h4 id="toc_4">Diffusion Equation</h4>

<p>The heat equation more generally describes the phenomenon of <em>diffusion</em>, when \(\alpha\) is replaced by a scalar constant \(D\) and \(T\) is replaced by the density of the diffusing material \(\phi\).</p>

<p>\[ \ppt{\phi} = D\lapl{\phi}. \]</p>

<h4 id="toc_5">Random walks</h4>

<p>The diffusion equation can also be used to describe the phenomenon of random walks, such as Brownian motion, by setting \(\phi = P(\ve{x}, t)\) to the probability of finding the walker at position \(\ve{x}\) at time \(t\).</p>

<p>Consider a random walk in one dimension, where the walker takes time \(\tau\) per step of length \(\ell\). The probability \(p\) that the walker steps to the right is constant, so the probability \(q\) that the walker steps left is simply \(1 - p\). In this discrete case, we set \(P_n(m)\) to be the probability of finding the walker at position \(x = m\ell\) at time \(t = n\tau\). Clearly, the walker can arrive at step \(m\) only if it stepped rightwards from \(m-1\) or leftwards from \(m+1\), so
\[ P_{n + 1}(m) = pP_n(m-1) + qP_n(m+1). \]</p>

<p>In the special case that a leftward and rightward step are equally likely, <em>i.e.</em> \(p = q = 1/2\), 
\[ P_{n+1}(m) - P_n(m) = \frac12(P_n(m+1) - P_n(m)) - \frac12 (P_n(m) - P_n(m - 1)). \]
In the limit of large \(n\), we can approximate these quantities as differentials. Thus, using \(\delta n = \delta t /\tau\) and \(\delta m = \delta x /\ell\), we obtain
\[ \tau\ppt{P} = \frac{\ell^2}{2}\pp[2]{P}{x}. \]</p>

<p>With some rearrangement and setting \(\ell^2/2\tau = D\), we identify this as the diffusion equation.</p>

<blockquote>
<p><strong>Question</strong>: What does this PDE look like for \(p \neq q\)?<br>
<em>Response</em>: Note that in the discrete case, the probability function \(P_n\) can be shown to form a Binomial distribution \(B(a, p)\). This is true because the probability of reaching position \(m\) from \(0\) in \(n\) steps along a single path with \(a\) steps to the right and \(b = n - a\) steps to the left is simply \(p^aq^b\). This is true of every path of this form, of which there are \(n!/(a!b!)\). Also, we must have exactly \(m\) more steps to the right than to the left, so \(a = (n + m)/2\), \(b = (n - m)/2\). Thus,
\[ P_n(m) = p_n(a) = \binom{n}{a}\,p^aq^{n-a}. \]
Note that \(p_n(a)\) is simply the coefficient of \(x^a\) in the binomial expansion \((px + q)^n\), so by setting \(x=1\), we verify that the sum of probabilities over all \(a\), ranging from \(0\) to \(n\) is exactly \(1\).
The expectation value of the number of rightward steps is simply \(\E{a} = np\), so the expected position of the walker is \(\E{m} = 2\E{a} - n = n(p - q)\), so \(\E{x} = n(p - q)\ell = (p-q)t\ell/\tau = vt\).
\[ v = (p-q)\frac{\ell}{\tau}, \quad\quad D = 2pq\frac{\ell^2}{\tau}. \]
Here, we set \(v\) to be the <em>drift velocity</em> of the walker.
The variance of \(a\) is simply \(npq\), so \(\E{(m - \E{m})^2} = \E{m^2} - \E{m}^2 = 4npq\). Thus, the variance of the \(x\) coordinate is given by \(4npq\ell^2 = 4pqt\ell^2/\tau = 2Dt\).</p>

<p>A famous consequence of this this that when \(p = q = 1/2\), the expected value of the squared displacement from the origin is given by \(\E{m^2} = n\). Thus, the expected <em>distance</em> from the origin is simply \(\sqrt{t\ell^2/\tau}\).</p>

<p>By performing the limit to the continuum \((\ell, \tau) \to (0, 0)\) on the rate equation while keeping \(v\) and \(D\) constant, we obtain the equation of diffusion
\[ \ppt{P} = -v\ppx{P} + D\pp[2]{P}{x}. \]
One solution of this equation is the Gaussian distribution
\[ P(x, t) = \frac{1}{\sqrt{4\pi Dt}}\exp\left(\frac{-(x - vt)^2}{4Dt}\right), \]
with the initial value \(P(x, 0) = \delta(x)\).<br>
The above equation is also easily generalized to higher dimensions.</p>
</blockquote>

<blockquote>
<p><strong>Question</strong>: In the limiting process, the ratio \(\ell^2/\tau\) is held constant. This seems to imply that the speed/drift velocity of the particle \(\ell/\tau\) blows up. How do we reconcile this?</p>
</blockquote>

<blockquote>
<p><strong>Question</strong>: How does this general equation for random walks relate to the diffusion of particles?<br>
<em>Response</em>: For a large collection of particles performing such a random walk, it is clear that the density of molecules \(n(\ve{x}, t)\) is simply proportional to the probability of a molecule being at \((\ve{x}, t)\), so \(n(\ve{x}, t) = n_{tot}P(\ve{x}, t)\). We define the current density of particles \(\ve{j}(\ve{x}, t)\) and note that analogous to Fourier&#39;s law, particles tend to move from regions of higher density to regions of lower density. This is called Fick&#39;s law, which states
\[ \ve{j}(\ve{x}, t) = -D\, \grad{n}(\ve{r}, t). \]
The constant streaming of particles with a drift velocity \(\ve{v}\) introduces an additional flux term, so 
\[ \ve{j}(\ve{x}, t) = \ve{v}n(\ve{x}, t) - D\, \grad{n}(\ve{r}, t). \]
The conservation of the number of particles is expressed by the continuity equation
\[ \ppt{}n(\ve{x}, t) + \divg{\ve{j}(\ve{x}, t)} = 0. \]
Plugging in the expression for \(\ve{j}(\ve{x}, t)\) yields
\[ \ppt{}n(\ve{x}, t) = -\ve{v}\cdot\grad{n(\ve{x}, t)} \,+\, D\,\lapl{n(\ve{x}, t)}. \]</p>
</blockquote>

<h3 id="toc_6">Laplace&#39;s Equation</h3>

<p>\[ \lapl{\phi}(\ve{x}) = 0. \]
This equation is often used to describe various physical potentials \(\phi(\ve{x})\), such as gravitational or electrostatic potential in regions without matter or charge respectively.</p>

<h3 id="toc_7">Poisson&#39;s Equation</h3>

<p>\[ \lapl{\phi(\ve{x})} = f(\ve{x}). \]
This equation is often used to describe potentials in the presence of some &#39;source&#39;, such as gravitational or electrostatic potentials in the presence of matter or charge. Here, \(f(\ve{x})\) is often called the <em>source density</em>. Note that this is a special case of the heat equation where the function \(T(\ve{x})\) is independent of time.</p>



<script type="text/javascript">
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1],i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(!s||!i)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var m=r[p];if(r.length>e.length)break e;if(!(m instanceof a)){u.lastIndex=0;var y=u.exec(m),v=1;if(!y&&h&&p!=r.length-1){var b=r[p+1].matchedStr||r[p+1],k=m+b;if(p<r.length-2&&(k+=r[p+2].matchedStr||r[p+2]),u.lastIndex=0,y=u.exec(k),!y)continue;var w=y.index+(g?y[1].length:0);if(w>=m.length)continue;var _=y.index+y[0].length,P=m.length+b.length;if(v=3,P>=_){if(r[p+1].greedy)continue;v=2,k=k.slice(0,P)}m=k}if(y){g&&(f=y[1].length);var w=y.index+f,y=y[0].slice(f),_=w+y.length,S=m.slice(0,w),O=m.slice(_),j=[p,v];S&&j.push(S);var A=new a(i,c?n.tokenize(y,c):y,d,y,h);j.push(A),O&&j.push(O),Array.prototype.splice.apply(r,j)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.matchedStr=a||null,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o="";for(var s in l.attributes)o+=(o?" ":"")+s+'="'+(l.attributes[s]||"")+'"';return"<"+l.tag+' class="'+l.classes.join(" ")+'" '+o+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
</script>

<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
