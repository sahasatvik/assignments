\documentclass[11pt]{article}

\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{amsmath, amssymb, amsthm}
\usepackage[scr]{rsfso}
\usepackage[%
    hidealllines=true,%
    innerbottommargin=15,%
    nobreak=true,%
]{mdframed}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{lipsum}
\usepackage{hyperref}

\geometry{a4paper, margin=1in, headheight=14pt}

\pagestyle{fancy}
\fancyhf{}
\renewcommand\headrulewidth{0.4pt}
\fancyhead[L]{\scshape MA2201: Analysis II}
\fancyhead[R]{\scshape Differentiation}
\rfoot{\footnotesize\it Updated on \today}
\cfoot{\thepage}

\def\C{\mathbb{C}}
\def\R{\mathbb{R}}
\def\Q{\mathbb{Q}}
\def\Z{\mathbb{Z}}
\def\N{\mathbb{N}}
\newcommand\ddx[1]{\frac{d #1}{d x}}
\newcommand\ddt[1]{\frac{d #1}{d t}}
\newcommand\dd[3][]{\frac{d^{#1}{#2}}{d {#3}^{#1}}}
\newcommand\ppx[1]{\frac{\partial #1}{\partial x}}
\newcommand\ppt[1]{\frac{\partial #1}{\partial t}}
\newcommand\pp[3][]{\frac{\partial^{#1}{#2}}{\partial {#3}^{#1}}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}

\newcounter{module}
\setcounter{module}{3}

\newmdtheoremenv[%
    backgroundcolor=blue!10!white,%
]{theorem}{Theorem}[module]
\newmdtheoremenv[%
    backgroundcolor=violet!10!white,%
]{corollary}{Corollary}[theorem]
\newmdtheoremenv[%
    backgroundcolor=teal!10!white,%
]{lemma}[theorem]{Lemma}

\theoremstyle{definition}
\newmdtheoremenv[%
    backgroundcolor=green!10!white,%
]{definition}{Definition}[module]
\newmdtheoremenv[%
    backgroundcolor=red!10!white,%
]{exercise}{Exercise}[module]

\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{example}{Example}
\newtheorem*{solution}{Solution}

\surroundwithmdframed[%
    linecolor=black!20!white,%
    hidealllines=false,%
    innertopmargin=5,%
    innerbottommargin=10,%
    skipabove=0,%
    skipbelow=0,%
]{example}

\numberwithin{equation}{module}

\title{
    \Large\textsc{MA2201: Analysis II} \\
    % \vspace{10pt}
    \Huge \textbf{Integration} \\
    \vspace{5pt}
    \Large{Spring 2021}
}
\author{
    \large Satvik Saha%
    % \thanks{Email: \tt ss19ms154@iiserkol.ac.in}
    \\\textsc{\small 19MS154}
}
\date{\normalsize
    \textit{Indian Institute of Science Education and Research, Kolkata, \\
    Mohanpur, West Bengal, 741246, India.} \\
    % \vspace{10pt}
    % \today
}

\begin{document}
    \maketitle

    \begin{definition}[Partition]
        A partition $P$ of an interval $[a, b]$ is a finite sequence of numbers \[
            a = x_0 < x_1 < \dots < x_{n - 1} < x_n = b.
        \] The norm of a partition is defined as \[
            \norm{P} = \max |x_{j + 1} - x_j|.
        \] 
    \end{definition}
    
    \begin{definition}[Tagged partition]
        A tagged partition $\dot{P}(x_j, \xi_j)$ is a partition $P$ together with a set of
        numbers $\xi_j$ such that $\xi_j \in [x_j, x_{j + 1}]$.
    \end{definition}

    \begin{definition}[Riemann sum]
        The Riemann sum of a function $f$ on an interval $[a, b]$ with respect to a
        tagged partition $\dot{P}$ is defined as \[
            S(f, \dot{P}) = \sum_{j = 0}^{n - 1}  f(\xi_j)(x_{j + 1} - x_j). 
        \] 
    \end{definition}

    \begin{definition}[Riemann integral]
        A function $f$ is called Riemann integrable on an interval $[a, b]$ if 
        there is some $\ell \in \R$ where for every $\epsilon > 0$, there exists
        $\delta > 0$ such that all tagged partitions $\dot{P}$ of $[a, b]$ with
        $\Vert\dot{P}\Vert < \delta$ satisfy \[
            |S(f, \dot{P}) - \ell| < \epsilon.
        \] The number $\ell$ is the value of the Riemann integral, \[
            \int_a^b f = \ell.
        \] 
    \end{definition}

    \begin{theorem}
        If a function is Riemann integrable on an interval, then the value of the
        integral is unique.
    \end{theorem}
    \begin{proof}
        Let $f$ be Riemann integrable on $[a, b]$, with integral values $\ell$ and
        $\ell'$. Then, for every $\epsilon > 0$, we find $\delta > 0$ such that for
        all tagged partitions $\dot{P}$ with $\Vert\dot{P}\Vert < \delta$, \[
            |S(f, \dot{P}) - \ell| < \frac{\epsilon}{2}, \qquad
            |S(f, \dot{P}) - \ell'| < \frac{\epsilon}{2}.
        \] Note that such a partition $\dot{P}$ always exists. Thus, \[
            |\ell - \ell'| \leq |S(f, \dot{P}) - \ell| + |S(f, \dot{P}) - \ell'| <
            \epsilon
        \] for all $\epsilon > 0$, which forces $\ell = \ell'$.
    \end{proof}

    \begin{theorem}\label{th:bounded}
        If $f$ is Riemann integrable on $[a, b]$, then $f$ is bounded on that interval.
        Furthermore, if $M > 0$ is such that $|f(x)| \leq M$ for all $x \in [a, b]$,
        then \[
            -M(b - a) \leq\, \int_a^b f \,\leq M(b - a).
        \] 
    \end{theorem}
    \begin{proof}
        Suppose not. Let the Riemann integral of $f$ on $[a, b]$ be $\ell$. For
        $\epsilon = 1$, we find $\delta > 0$ such that for all tagged partitions
        $\dot{P}$ of $[a, b]$ with $\Vert\dot{P}\Vert < \delta$, we have $|S(f,
        \dot{P}) - \ell| < 1$. This means that \[
            S(f, \dot{P}) < |\ell| + 1.
        \] Let $Q = \{x_0, \dots, x_n\}$ be such a partition. The unboundedness of
        $f$ means that we can find a subinterval $[x_k, x_{k + 1}]$ where $f$ is
        unbounded. Now, choose tags $\xi_j$ creating the tagged partition $\dot{Q}$.
        We choose the tag $\xi_k \in [x_k, x_{k + 1}]$ such
        that \[
            |f(\xi_k)(x_{k + 1} - x_k)| > |\ell| + 1 + |\sum_{j \neq k}
            f(\xi_j)(x_{j + 1} - x_j)|.
        \] Now, observe that the triangle inequality demands \[
            |S(f, \dot{Q})| \geq |f(\xi_{k})(x_{k + 1} - x_k)| - |\sum_{j \neq k}
            f(\xi_j)(x_{j + 1} - x_j)| > |\ell| + 1,
        \] which is a contradiction. Thus, $f$ must be bounded on $[a, b]$. \\
        
        \noindent
        Next, for any tagged partition $\dot{P}$ of $[a, b]$, we have \[
            |S(f, \dot{P})| \leq \sum_{j = 0}^{n - 1}|f(\xi_j)(x_{j + 1} - x_j) \leq
            M(b - a).
        \] Let the Riemann integral of $f$ be $\ell$.
        Thus, for all $\epsilon > 0$, we find $\delta > 0$ such that for all
        tagged partitions $\dot{P}$ with $\Vert\dot{P}\Vert < \delta$, \[
            | |S(f, \dot{P})| - |\ell| | \leq |S(f, \dot{P}) - \ell| < \epsilon.
        \] This gives \[
            |\ell| < |S(f, \dot{P})| + \epsilon \leq M(b - a) + \epsilon.
        \] Since this holds for all $\epsilon > 0$, we may write \[
            |\ell| \leq M(b - a). \qedhere
        \] 
    \end{proof}

    \begin{theorem}
        If $f$ is Riemann integrable on $[a, b]$, and $\dot{P}_n$ is any sequence of
        tagged partitions of $[a, b]$ such that $\Vert\dot{P}_n\Vert \to 0$, then \[
            \int_a^b f = \lim_{n \to \infty} S(f, \dot{P}_n).
        \] 
    \end{theorem}
    \begin{proof}
        Let $\epsilon > 0$. We find $\delta > 0$ such that for all tagged partitions
        $\dot{P}$ with $\Vert\dot{P}\Vert < \delta$, we have \[
            |S(f, \dot{P})  - \int_a^b f| < \epsilon.
        \] Now, since $\Vert\dot{P}_n\Vert \to 0$, we can choose $N \in \N$ such
        that for all $n \geq N$, $\Vert\dot{P}_n\Vert < \delta$. Thus, for all $n
        \geq N$, \[
            |S(f, \dot{P}_n)  - \int_a^b f| < \epsilon.
        \] In other words, \[
            \int_a^b f = \lim_{n \to \infty} S(f, \dot{P}_n). \qedhere
        \] 
    \end{proof}


    \begin{definition}[Refinement]
        A partition $\tilde{P}$ is said to be a refinement of a partition $P$ if
        $P\subset \tilde{P}$.
    \end{definition}

    \begin{definition}[Common refinement]
        Given two partitions $P_1$ and $P_2$ of an interval $[a, b]$, we say that
        $\tilde{P}$ is their common refinement if $P_1 \cup P_2 \subset \tilde{P}$.
    \end{definition}

    \begin{definition}[Darboux sums]
        Given a partition $P$ of $[a, b]$ and a bounded function $f$, define \[
            m_j = \inf_{t \in [x_{j}, x_{j + 1}]} f(t), \qquad
            M_j = \sup_{t \in [x_{j}, x_{j + 1}]} f(t).
        \] The lower and upper Darboux sums are defined as \[
            L(f, P) = \sum_{j = 0}^{n - 1} m_j(x_{j + 1} - x_j), \qquad
            U(f, P) = \sum_{j = 0}^{n - 1} M_j(x_{j + 1} - x_j).
        \] 
    \end{definition}

    \begin{lemma}
        If $P$ is a partition of an interval $[a, b]$, then \[
            L(f, P) \leq U(f, P).
        \] 
    \end{lemma}
    \begin{proof}
        This follows directly from the fact that the infimum is less than or equal
        to the supremum, i.e.\ $m_j \leq M_j$.
    \end{proof}
    \begin{theorem}
        Let $\tilde{P}$ be a refinement of a partition $P$ of an interval $[a, b]$.
        Then, \[
            L(f, P) \leq L(f, \tilde{P}) \leq U(f, \tilde{P}) \leq U(f, P)
        \] 
    \end{theorem}
    \begin{proof}
        Suppose that \[
            P = \{x_0, \dots, x_k, x_{k + 1}, \dots, x_n\},
        \] \[
            \tilde{P} = \{x_0, \dots, x_k, y, x_{k + 1}, \dots, x_n\}.
        \] Set \[
            m_1 = \inf_{t \in [x_{k}, y]}f(t), \qquad 
            m_2 = \inf_{t \in [y, x_{k + 1}]}f(t), \qquad
            m = \inf_{t \in [x_k, x_{k + 1}]}f(t).
        \] Then, observe that \[
            L(f, \tilde{P}) - L(f, P) = m_1(y - x_k) + 
            m_2(x_{k + 1} - y) - 
            m(x_{k + 1} - x_k).
        \] Now, from the properties of the infimum, $m_1 \geq m$ and $m_2 \geq m$,
        so \[
            L(f, \tilde{P}) - L(f, P) \geq m(y - x_k + x_{k + 1} - y - x_{k + 1} +
            x_k) = 0.
        \] This procedure of adding one point can be repeated finitely many times to
        obtain the same conclusion for any refinement of $P$. The case for the upper
        sum is analogous.
    \end{proof}

    \begin{corollary}
        For any two partitions $P_1$ and $P_2$ of $[a, b]$, \[
            L(f, P_1) \leq U(f, P_2).
        \] 
    \end{corollary}
    \begin{proof}
        Note that $P_1\cup P_2$ is a common refinement of $P_1$ and $P_2$,
        hence \[
            L(f, P_1) \leq L(f, P_1 \cup P_2) \leq U(f, P_1\cup P_2) \leq U(f, P_2).
            \qedhere
        \] 
    \end{proof}
    \begin{corollary}
        If $\{P_n\}$ is a sequence of refinements of a partition $P_0$ of $[a, b]$,
        then the following limits exist. \[
            L_{f, P_n} = \lim_{n \to \infty} L(f, P_n), \qquad 
            U_{f, P_n} = \lim_{n \to \infty} U(f, P_n). 
        \]
    \end{corollary}
    \begin{proof}
        This follows from the monotone convergence theorem, together with the fact
        that $U(f, P_0)$ and $L(f, P_0)$ are upper and lower bounds of the two
        respective sequences.
    \end{proof}

    \begin{corollary}
        The following quantities exist, where the infimum and supremum is taken over
        all possible partitions $P$ of $[a, b]$. \[
            L_f = \sup L(f, P), \qquad U_f = \inf U(f, P).
        \] Furthermore, for any partition $P$, \[
            L(f, P) \leq L_f \leq U_f \leq U(f, P).
        \] 
    \end{corollary}
    \begin{proof}
        First examine the set of all lower Darboux sums, $\{L(f, P)\}$. This set is
        non-empty, since any partition of $[a, b]$ gives a corresponding lower sum.
        Note that we have already demanded that $f$ is bounded!
        This set is also bounded above, by any upper sum. Thus, the completeness of
        the reals guaranteed the existence of a supremum. The case for upper sums is
        analogous. \\

        \noindent The outermost inequalities trivially follow from the definitions
        of the infimum and supremum. The middle inequality follows from the fact
        that if $A$ and $B$ are two subsets of $\R$ such that $\alpha \in A, \beta
        \in B$ implies $\alpha \leq \beta$, then $\sup{A} \leq \inf{B}$.
    \end{proof}
    
    \begin{definition}[Darboux integrals]
        The lower and upper Darboux integrals of a function $f$ are defined as \[
            L_f = \sup L(f, P), \qquad U_f = \inf U(f, P).
        \] Here, the infimum and supremum is taken over all possible partitions $P$
        of $[a, b]$.

        If $L_f = U_f$, then the common integral is simply called the Darboux
        integral, \[
            \int_a^b f = L_f = U_f.
        \] Such a function $f$ is called Darboux integrable.
    \end{definition}
    
    \begin{theorem}
        A function $f$ is Darboux integrable on $[a, b]$ if and only if for every
        $\epsilon > 0$, there exists a partition $P$ such that \[
            U(f, P) - L(f, P) < \epsilon.
        \] 
    \end{theorem}
    \begin{proof}
        First, assume that given $\epsilon > 0$, there exists a partition $P$ such
        that \[
            U(f, P) - L(f, P) < \epsilon.
        \] By the previous corollary, \[
            U_f - L_f \leq U(f, P) - L(f, P) < \epsilon
        \] for all $\epilon > 0$, so $U_f = L_f$ giving Darboux integrability. \\

        \noindent
        Now, suppose that $f$ is Darboux integrable on $[a, b]$. This means that
        $U_f = L_f$. Using the definitions of supremum and infimum, for $\epsilon >
        0$, there exists a partition $P_1$ such that $U(f, P_1) - U_f < \epsilon /
        2$ and a partition $P_2$ such that $L_f - L(f, P_2) < \epsilon / 2$. Adding,
        \[
            U(f, P_1) - L(f, P_2) < \epsilon.
        \] Now, setting $P = P_1 \cup P_2$ as a common refinement of $P_1$ and
        $P_2$, we have \[
            U(f, P) - L(f, P) < U(f, P_1) - L(f, P_2) < \epsilon. \qedhere
        \] 
    \end{proof}

    \begin{lemma}
        Let $f$ be bounded on $[a, b]$, and let $P'$ be any partition of that
        interval. Then for every $\epsilon > 0$, there exists a $\delta > 0$ such that
        for all partitions $P$ with $\norm{P} < \delta$, \[
            U(f, P) - U(f, P \cup P') < \epsilon.
        \] 
    \end{lemma}
    \begin{proof}
        Using the boundedness of $f$, choose $M \in \R$ such that $|f(x)| < M$ for
        all $x \in [a, b]$. Suppose that $P' = \{x_1, \dots, x_n\}$. Set $\delta =
        \epsilon / 4nM$. Now, let $P$ be any partition of $[a, b]$ with $\norm{P} <
        \delta$. Write $P = \{y_i\}$, and $P\cup P' = \{z_i\}$ where all these sets
        are ordered. Now, note that if one of the subintervals $[z_j, z_{j + 1}]$
        does not contain a point $x_i$, then the term $M_j(y_{j + 1} - y_{j})$
        cancels from $U(f, P) - U(f, P\cup P')$. Whenever there is an $x_i$ in
        $[z_j, z_{j + 1}]$, we have a term of the form \[
            M_j(y_{j + 1} - y_j) - M'(x_i - y_j) - M''(y_{j + 1} - x_i),
        \] where $M', M''$ are the supremums over the two pieces, each less than
        $M$. This means that this term is bounded by $4M\delta$. Since this can
        happen at most $n$ times, \[
            U(f, P) - U(f, P \cup P') < 4nM\delta = \epsilon. \qedhere
        \] 
    \end{proof}

    \begin{theorem}
        Riemann and Darboux integrability are equivalent and assign the same value
        to the integrals. 
    \end{theorem}
    \begin{proof}
        First assume that $f$ is Riemann integrable on $[a, b]$. By
        Theorem~\ref{th:bounded}, $f$ is bounded so the Darboux upper and lower sums
        are well defined. Given $\epsilon > 0$, we seek a partition $P$ such that \[
            U(f, P) - L(f, P) < \epsilon.
        \] Now, Riemann integrability guarantees the existence of a $\delta > 0$
        such that for all tagged partitions $\dot{P}$ with $\Vert\dot{P}\Vert <
        \delta$, \[
            |S(f, P) - \ell| < \frac{\epsilon}{3}
        \] where $\ell$ is the value of the Riemann integral. Choose $P$ with $n$
        subintervals. Now, let $\dot{P}_\xi$ be tagged with $\xi_j$ and
        $\dot{P}_\zeta$ be tagged with $\zeta_j$. From the definitions of the
        infimum and supremum, we choose our tags such that \[
            f(\xi_j)  - m_j < \frac{\epsilon}{6(b - a)}, \qquad 
            M_j - f(\zeta_j) < \frac{\epsilon}{6(b - a)}.
        \] This gives \[
            M_j - m_j < f(\xi_j) - f(\zeta_j) + \frac{\epsilon}{3(b - a)}.
        \] Thus, \begin{align*}
            U(f, P) - L(f, P) &< \sum_{j = 0}^{n - 1} \left(f(\xi_j) - f(\zeta_j) +
            \frac{\epsilon}{3(b - a)}\right)(x_{j + 1} - x_{j}) \\
            &< S(f, \dot{P}_\xi) - S(f, \dot{P}_\zeta) + \frac{\epsilon}{3(b -
            a)}\cdot(b - a) \\
            &< |S(f, \dot{P}_\xi) - \ell| + |\ell - S(f, \dot{P}_\zeta)| +
            \frac{\epsilon}{3} \\
            &< \epsilon.
        \end{align*}
        This proves that $f$ is Darboux integrable on $[a, b]$, i.e.\ $U_f = L_f$.
        We now wish to show that $U_f = L_f = \ell$. Let $\epsilon > 0$. Using the
        properties of the infimum and supremum, we find partitions $P_1, P_2$ and
        $\dot{P}_3$ such that \[
            L_f - L(f, P_1) < \frac{\epsilon}{6}, \qquad
            U(f, P_2) - U_f < \frac{\epsilon}{6}, \qquad
            |S(f, \dot{P}_3) - \ell| < \frac{\epsilon}{3}.
        \] Setting $P = P_1 \cup P_2 \cup P_3$, \[
            L_f - L(f, P) < \frac{\epsilon}{6}, \qquad
            U(f, P) - U_f < \frac{\epsilon}{6}, \qquad
            |S(f, \dot{P}) - \ell| < \frac{\epsilon}{3}.
        \] Now, \[
            L(f, P) \leq S(f, \dot{P}) \leq U(f, P) < L(f, P) + \frac{\epsilon}{3}.
        \] This means that $S(f, \dot{P}) - L(f, P) < \epsilon / 3$. Now, \[
            |\ell - L_f| \leq |\ell - S(f, \dot{P})| + |S(f, \dot{P}) - L(f, P)| +
            |L(f, P) - L_f| < \epsilon.
        \] This forces $U_f = L_f = \ell$.
        \begin{center}
            \rule{5em}{0.5pt}
        \end{center}

        \noindent
        Now assume that $f$ is Darboux integrable on $[a, b]$. This means that $U_f
        = L_f$. For $\epsilon > 0$, choose a partition $P'$ such that \[
            U(f, P') - U_f < \frac{\epsilon}{2}.
        \] Set $\delta_1 = \epsilon / 8nM$, and use our previous lemma to conclude
        that for any partition $P$ of $[a, b]$ with $\norm{P} < \delta_1$, \[
            U(f, P) < U(f, P \cup P') + \frac{\epsilon}{2} \leq U(f, P') +
            \frac{\epsilon}{2} < U_f + \epsilon.
        \] Similarly, we can choose $\delta_2 > 0$ such that for all partitions $P$
        with $\norm{P} < \delta_2$, \[
            L(f, P) > L_f - \epsilon.
        \] Setting $\delta = \min\{\delta_1, \delta_2\}$, we have \[
            L_f - \epsilon < L(f, P) < S(f, \dot{P}) < U(f, P) < U_f + \epsilon.
        \] Thus, for all tagged partitions $\dot{P}$ with $\Vert\dot{P}\Vert <
        \delta$, we have \[
            |S(f, \dot{P}) - U_f| < \epsilon. \qedhere
        \] 

        \end{proof}

    \begin{theorem}
        Any real continuous function on $[a, b]$ is Riemann integrable.
    \end{theorem}
    \begin{proof}
        Note that any continuous function on a compact interval is uniformly continuous.
        Thus, for $\epsilon > 0$, there exists $\delta > 0$ such that for all $x, y
        \in [a, b]$, we have \[
            |f(x) - f(y)| < \frac{\epsilon}{b - a}.
        \] Now, construct a partition of $[a, b]$ which divides the interval into
        equal subintervals of length $(b - a) / n$, where $n$ is chosen such that
        $\Vert P\Vert < \delta$. This immediately gives \[
            U(f, P) - L(f, P) = \sum_{j = 0}^{n - 1} (M_j - m_j)\cdot \frac{1}{n}(b
            - a) \leq n\cdot \frac{\epsilon}{b - a}\cdot \frac{b - a}{n} = \epsilon.
            \qedhere
        \] 
    \end{proof}

    \begin{theorem}
        Any bounded, monotone function on $[a, b]$ is Riemann integrable.
    \end{theorem}
    \begin{proof}
        Without loss of generality, suppose that $f$ is monotonically increasing.
        Now, $f$ on each interval attains its minimum and maximum at the endpoints,
        so \[
            U(f, P) - L(f, P) = \sum_{j = 0}^{n - 1} (f(x_{j + 1}) - f(x_j))(x_{j +
            1} - x_j).
        \] Let $\epsilon > 0$. Choose $P$ such that each subinterval has length $(b
        - a) / n$. Since $f$ is bounded on $[a, b]$, we can choose $n$ to be
        sufficiently large such that \[
            U(f, P) - L(f, P) = (f(b) - f(a))\frac{b - a}{n} < \epsilon. \qedhere
        \] 
    \end{proof}

\end{document}
% vim: set tabstop=4 shiftwidth=4 softtabstop=4:
